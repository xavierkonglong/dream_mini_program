<!--å¸–å­è¯¦æƒ…é¡µ-->
<view class="container language-{{language}}">
  <!-- å¸–å­å†…å®¹ -->
  <view class="post-content" wx:if="{{postData}}">
    <!-- æ¢¦å¢ƒå†…å®¹ -->
    <view class="dream-content-section">
      <view class="section-title">{{i18n.postDetail.dreamContent}}</view>
      <view class="cloud-card dream-content-card">
        <text class="dream-text">{{postData.dreamDescription}}</text>
      </view>
    </view>

    <!-- å…³é”®è¯ -->
    <view class="keywords-section" wx:if="{{postData.keywords && postData.keywords.length > 0}}">
      <view class="section-title">{{i18n.postDetail.keywords}}</view>
      <view class="keywords-container">
        <view class="keyword-tag" wx:for="{{postData.keywords}}" wx:key="index">
          {{item}}
        </view>
      </view>
    </view>

    <!-- æ¢¦å¢ƒè§£æž -->
    <view class="analysis-section" wx:if="{{postData && postData.interpretation}}">
      <view class="section-title">{{i18n.postDetail.analysis}}</view>
      <view class="cloud-card analysis-card">
        <view class="analysis-content">
          <!-- ç›´æŽ¥æ˜¾ç¤ºåˆ†æ®µå†…å®¹ -->
          <view class="analysis-paragraph" wx:for="{{postData.interpretationParagraphs}}" wx:key="index">
            {{item}}
          </view>
        </view>
        <view class="ai-disclaimer">
          <text class="disclaimer-text">{{i18n.postDetail.aiDisclaimer}}</text>
        </view>
      </view>
    </view>
    

    <!-- AIæ¢¦å¢ƒè§†é¢‘ -->
    <view class="video-section" wx:if="{{postData.videoUrl}}">
      <view class="section-title">{{i18n.postDetail.aiVideo}}</view>
      <view class="video-container">
        <video class="dream-video" src="{{postData.videoUrl}}" controls="{{true}}" show-center-play-btn="{{true}}" show-play-btn="{{true}}" muted="{{false}}" loop="{{false}}" autoplay="{{false}}" poster="{{postData.imageUrl || ''}}"></video>
      </view>
      <view class="video-description" wx:if="{{postData.videoPrompt}}">
        <text class="description-text">{{postData.videoPrompt}}</text>
      </view>
    </view>

    <!-- AIæ¢¦å¢ƒå›¾åƒ -->
    <view class="image-section" wx:elif="{{postData.imageUrl}}">
      <view class="section-title">{{i18n.postDetail.aiImage}}</view>
      <view class="image-container">
        <image class="dream-image" src="{{postData.imageUrl}}" mode="aspectFill" bindtap="onPreviewImage" />
      </view>
      <view class="image-description" wx:if="{{postData.imagePrompt}}">
        <text class="description-text">{{postData.imagePrompt}}</text>
      </view>
    </view>

    <!-- äº’åŠ¨æŒ‰é’®åŒºåŸŸ -->
    <view class="action-buttons">
      <view class="action-btn like-btn {{postData.isLiked ? 'liked' : ''}}" bindtap="onToggleLike">
        <van-icon size="32rpx" name="{{postData.isLiked ? 'like' : 'like-o'}}" class="action-icon {{postData.isLiked ? 'liked' : ''}}" />
        <text class="action-text">{{postData.isLiked ? i18n.postDetail.liked : i18n.postDetail.like}}</text>
      </view>

      <view class="action-btn favorite-btn {{postData.isFavorited ? 'favorited' : ''}}" bindtap="onToggleFavorite">
        <van-icon size="32rpx" name="{{postData.isFavorited ? 'star' : 'star-o'}}" class="action-icon {{postData.isFavorited ? 'favorited' : ''}}" />
        <text class="action-text">{{postData.isFavorited ? i18n.postDetail.favorited : i18n.postDetail.favorite}}</text>
      </view>

      <!-- å·²æŒ‰éœ€æ±‚ç§»é™¤åˆ†äº«æŒ‰é’® -->
    </view>
  </view>

  <!-- æ— æ•°æ®çŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-content">
      <text class="empty-icon">ðŸŒ™</text>
      <text class="empty-text">{{i18n.postDetail.postNotFound}}</text>
    </view>
  </view>

  <!-- ç™»å½•å¼¹çª— -->
  <login-modal show="{{showLoginModal}}" title="{{i18n.postDetail.loginRequired}}" subtitle="{{i18n.postDetail.loginSubtitle}}" bind:loginSuccess="onLoginSuccess" bind:close="onCloseLoginModal" />
</view>