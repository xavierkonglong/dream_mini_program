<!--È¶ñÈ°µ-->
<view class="container language-{{language}}">
  <!-- ËÉåÊôØÂõæÁâá -->
  <image class="background-image" src="{{imageUrls.BACKGROUNDS.INDEX}}" mode="aspectFill"></image>
  
  <!-- Âè≥‰∏äËßíÂäüËÉΩÂå∫ -->
  <view class="top-actions">
    <!-- Á≠æÂà∞ÂÖ•Âè£ -->
    <view class="checkin-entry" bindtap="goToCheckin">
      <text class="checkin-icon">üéÅ</text>
    </view>
    <!-- ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ -->
    <view class="language-toggle" bindtap="onLanguageToggle">
      <text class="language-text">{{language === 'zh' ? 'EN' : '‰∏≠Êñá'}}</text>
    </view>
  </view>
  
  <!-- ‰∏ªÂÜÖÂÆπÂå∫Âüü -->
  <view class="main-content">
    <!-- ÊèêÁ§∫Âå∫Âüü -->
    <view class="hint-section">
      <view class="hint-title">{{i18n.index.title}}</view>
      <view class="hint-subtitle">{{i18n.index.subtitle}}</view>
    </view>
    
    <!-- ËæìÂÖ•Âå∫Âüü -->
    <view class="input-section">
      <view class="input-field glass-effect {{inputFocused ? 'focused' : ''}}">
        <textarea 
          class="dream-input"
          placeholder="{{i18n.index.placeholder}}"
          value="{{dreamDescription}}"
          bindinput="onDreamInput"
          bindfocus="onInputFocus"
          bindblur="onInputBlur"
          maxlength="1000"
          show-confirm-bar="{{false}}"
        ></textarea>
        <view class="input-actions" wx:if="{{dreamDescription}}">
          <view class="char-count">{{dreamDescription.length}}/1000</view>
          <view class="clear-btn" bindtap="onClearInput">
            <text class="clear-icon">√ó</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- ÁîüÊàêÁ±ªÂûãÈÄâÊã© -->
    <view class="generation-type-section">
      <view class="generation-type-title">{{i18n.index.generationType}}</view>
      <radio-group class="generation-type-group" bindchange="onGenerationTypeChange">
        <label class="generation-type-item {{generationType === 'image' ? 'active' : ''}}">
          <radio value="image" checked="{{generationType === 'image'}}" color="#8B5CF6"/>
          <text>{{i18n.index.textToImage}}</text>
        </label>
        <label class="generation-type-item {{generationType === 'video' ? 'active' : ''}}">
          <radio value="video" checked="{{generationType === 'video'}}" color="#8B5CF6"/>
          <text>{{i18n.index.textToVideo}}</text>
        </label>
      </radio-group>
    </view>
    
    <!-- ÂàÜÊûêÊåâÈíÆ -->
    <view class="action-section">
      <button 
        class="analysis-button {{analyzing ? 'analyzing' : ''}}"
        bindtap="onAnalyzeDream"
        disabled="{{analyzing}}"
      >
        <text wx:if="{{!analyzing}}">{{i18n.index.analyze}}</text>
        <text wx:else>{{i18n.index.analyzing}}</text>
      </button>
    </view>
    
    <!-- ËøõÂ∫¶Êù° -->
    <view class="progress-section {{analyzing ? 'show' : ''}}">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progress}}%"></view>
      </view>
      <view class="progress-text" wx:if="{{analyzing}}">{{progressText}}</view>
    </view>
    
    <!-- ‰ΩøÁî®ÊèêÁ§∫ -->
    <view class="tips-section">
      <view class="tips-title">{{i18n.index.tipsTitle}}</view>
      <view class="tips-content">
        <view class="tip-item" wx:for="{{i18n.index.tips}}" wx:key="index">{{item}}</view>
      </view>
      <view class="tips-disclaimer">{{i18n.index.disclaimer}}</view>
    </view>
  </view>
  
  <!-- ÁôªÂΩïÂºπÁ™ó -->
  <login-modal 
    show="{{showLoginModal}}"
    title="{{i18n.loginModal && i18n.loginModal.title || 'Ê¨¢ËøéÊù•Âà∞Ê¢¶Â¢É‰∏ñÁïå'}}"
    subtitle="{{i18n.loginModal && i18n.loginModal.subtitle || 'ËØ∑ÂÖàÁôªÂΩï‰ª•‰ΩìÈ™åÂÆåÊï¥ÂäüËÉΩ'}}"
    bind:loginSuccess="onLoginSuccess"
    bind:loginCancel="onLoginCancel"
    bind:close="onCloseLoginModal"
  />
  
  <!-- ‰∏™‰∫∫‰ø°ÊÅØËÆæÁΩÆÂºπÁ™ó -->
  <profile-setup-modal 
    show="{{showProfileSetupModal}}"
    bind:setupComplete="onProfileSetupComplete"
    bind:close="onCloseProfileSetupModal"
  />
</view>

<!-- Ëá™ÂÆö‰πâtabBar -->
<custom-tabbar />